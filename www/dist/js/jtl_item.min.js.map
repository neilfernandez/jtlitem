{"version":3,"sources":["jtl_item.js"],"names":["$","widget","options","lang","lang_codes","messages","fieldSize","fieldRows","fieldMaxLength","dialogTitle","_createPrivateStorage","uiw","this","_values","apexItemId","controlsId","dataJSON","curr_lang_index","languages","tagMap","parseJSON","totalLanguages","disabled","focusOnClose","newRecord","signalChange","_elements","$window","$document","$body","$hiddenInput","$displayInput","$fieldset","$mlsButton","$dialog","$dialogContent","$saveButton","$cancelButton","$buttonContainer","_create","element","attr","_initElements","_initBaseElements","JSON","parse","length","_initDataJSON","_initLanguageMap","j","l","i","idx","language_index","bind","_syncHiddenField","_handleOpenClick","apex","debug","message","initPageItem","setValue","value","displayValue","val","getValue","setFocus","focus","enable","disable","window","document","body","_initDialogElements","itemType","find","jsonData","input_data","forEach","push","tl","stringify","eventObj","lang_index","data","_initDialogButtons","_handleCancelButtonClick","_handleSaveButtonClick","dialog","display_value","each","el","dataset","_signalChange","hiddenElmt","displayElmt","jQuery","trigger","_showDialog","tags","_hasTag","tagName","langTable","dialogHtml","curr_lang","languageLabel","languageValue","index","util","escapeHTMLAttr","cancelButton","applyChanges","append","closeOnEscape","title","autoResize","minWidth","minHeight","width","height","modal","position","my","at","of","open","first","close","remove","on","evt","keyCode","ui","ESCAPE","stopPropagation","unbind","removeAttr"],"mappings":";;;;;;AAOAA,EAAEC,OAAQ,eAGRC,SACGC,KAAM,KACNC,YAAa,KAAK,KAAK,MACvBC,SAAU,KACVC,UAAW,GACXC,UAAW,EACXC,eAAgB,GAChBC,YAAa,MAEhBC,sBAAuB,WACpB,IAAIC,EAAMC,KAEVD,EAAIE,SACDC,WAAY,GACZC,WAAY,GACZT,UAAW,GACXE,eAAgB,GAChBQ,YACAC,gBAAiB,EACjBC,aACAC,UACAd,SAAUL,EAAEoB,UAAUT,EAAIT,QAAQG,UAClCgB,eAAgB,EAChBC,UAAU,EACVC,aAAc,SACdC,WAAW,EACXC,cAAc,GAGjBd,EAAIe,WACDC,WACAC,aACAC,SACAC,gBACAC,iBACAC,aACAC,cACAC,WACAC,kBACAC,eACAC,iBACAC,sBAGNC,QAAS,WACP,IAAI5B,EAAMC,KAgBVD,EAAID,wBACJC,EAAIE,QAAQC,WAAad,EAAEW,EAAI6B,SAASC,KAAK,MAC7C9B,EAAIE,QAAQE,WAAaJ,EAAIE,QAAQC,WAAa,YAClDH,EAAI+B,gBACJ/B,EAAIgC,oBAEJhC,EAAIE,QAAQK,UAAY0B,KAAKC,MAAMlC,EAAIT,QAAQE,YAC/CO,EAAIE,QAAQQ,eAAiBV,EAAIE,QAAQK,UAAU4B,OAGnDnC,EAAIoC,gBACJpC,EAAIqC,mBAEJrC,EAAIE,QAAQI,gBAxBZ,SAAyBgC,EAAGC,GAC1B,IAAIC,EAAI,KACJC,GAAO,EACX,IAAKD,EAAI,EAAGF,EAAEH,OAASK,IAAa,GAARC,EAAWD,GAAK,EACtCF,EAAEE,GAAGD,IAAMA,IACbE,EAAMD,GAGV,OAAOC,EAgBqBC,CAAe1C,EAAIE,QAAQG,SAAUL,EAAIT,QAAQC,MAI/EQ,EAAIe,UAAUK,cACVuB,KAAK,UAAW3C,IAAKA,GAAMA,EAAI4C,kBACnC5C,EAAIe,UAAUE,UACV0B,KAAK,wBAAyB3C,IAAKA,GAAMA,EAAI4C,kBAEjD5C,EAAIe,UAAUO,WACVqB,KAAK,SAAU3C,IAAKA,GAAMA,EAAI6C,kBAElCC,KAAKC,MAAMC,QAAQ,EAAE,8CAAgDhD,EAAIe,UAAUK,cAAcU,KAAK,OAEtGgB,KAAKxD,OAAO2D,aAAajD,EAAIe,UAAUI,aAAaW,KAAK,OACtDoB,SAAU,SAASC,EAAOC,GACvBpD,EAAIe,UAAUK,cAAciC,IAAID,GAChCpD,EAAI4C,oBAEPU,SAAU,WACP,OAAOtD,EAAIe,UAAUI,aAAakC,OAErCE,SAAU,WACPvD,EAAIe,UAAUK,cAAcoC,SAQ/BC,OAAQ,WACLzD,EAAIyD,UAEPC,QAAS,WACN1D,EAAI0D,cAKZ3B,cAAe,WACZ,IAAI/B,EAAMC,KAEVD,EAAIe,UAAUC,QAAU3B,EAAEsE,QAC1B3D,EAAIe,UAAUE,UAAY5B,EAAEuE,UAC5B5D,EAAIe,UAAUG,MAAQ7B,EAAEuE,SAASC,MACjC7D,EAAIe,UAAUQ,QAAUlC,EAAE,uBAG7ByE,oBAAqB,WAClB,IAAI9D,EAAMC,KAEVD,EAAIe,UAAUQ,QAAUlC,EAAE,sBAC1BW,EAAIe,UAAUS,eAAiBnC,EAAE,uBACjCW,EAAIe,UAAUU,YAAcpC,EAAE,8BAC9BW,EAAIe,UAAUW,cAAgBrC,EAAE,iCAGnC2C,kBAAmB,WAChB,IAAIhC,EAAMC,KAEVD,EAAIe,UAAUI,aAAenB,EAAI6B,QACjC7B,EAAIe,UAAUK,cAAgB/B,EAAE,IAAMW,EAAIE,QAAQC,WAAa,YAC/DH,EAAIE,QAAQP,UAAqC,SAAzBK,EAAIT,QAAQwE,SAAqB/D,EAAIe,UAAUK,cAAcU,KAAK,QAAU9B,EAAIe,UAAUK,cAAcU,KAAK,QACxG,aAAzB9B,EAAIT,QAAQwE,WACd/D,EAAIE,QAAQN,UAAYI,EAAIe,UAAUK,cAAcU,KAAK,SAE3D9B,EAAIE,QAAQL,eAAiBG,EAAIe,UAAUK,cAAcU,KAAK,aAE9D9B,EAAIe,UAAUM,UAAYhC,EAAE,IAAMW,EAAIE,QAAQE,YAC9CJ,EAAIe,UAAUO,WACXtB,EAAIe,UAAUM,UAAU2C,KAAK,8BAEnC5B,cAAe,WACZ,IAAIpC,EAAMC,KACNgE,KACAC,EAAalE,EAAIe,UAAUI,aAAakC,MAExCa,GACDlE,EAAIE,QAAQG,SAAW4B,KAAKC,MAAMgC,GAClClE,EAAIE,QAAQW,WAAY,IAQxBb,EAAIE,QAAQK,UAAU4D,QAAQ,SAAS5B,GACpC0B,EAASG,MAAM7B,EAAKA,EAAG8B,GAAM,OAGhCrE,EAAIe,UAAUI,aAAakC,IAAIpB,KAAKqC,UAAUL,IAC9CjE,EAAIE,QAAQG,SAAW4D,EACvBjE,EAAIE,QAAQW,WAAY,IAI9B+B,iBAAkB,SAAS2B,GAExB,IAAIvE,EAEAwE,EAaJ,GAFAA,GAPGxE,OAFoB,IAAZuE,EAEFA,EAASE,KAAKzE,IAIdC,MAGQC,QAAQI,gBAErBN,EAAIE,QAAQW,UAEb,IAAK,IAAI2B,EAAIxC,EAAIE,QAAQQ,eAAiB,EAAG8B,GAAK,EAAGA,IACnDxC,EAAIE,QAAQG,SAASmC,GAAG6B,GAAKrE,EAAIe,UAAUK,cAAciC,WAK3DrD,EAAIE,QAAQG,SAASmE,GAAYH,GAAKrE,EAAIe,UAAUK,cAAciC,MAGrErD,EAAIe,UAAUI,aAAakC,IAAIpB,KAAKqC,UAAUtE,EAAIE,QAAQG,WAE1DL,EAAIqC,oBAEPqC,mBAAoB,WACjB,IAAI1E,EAAMC,KAEVD,EAAIe,UAAUW,cACViB,KAAK,SAAU3C,IAAKA,GAAMA,EAAI2E,0BAElC3E,EAAIe,UAAUU,YACVkB,KAAK,SAAU3C,IAAKA,GAAMA,EAAI4E,yBAGrCD,yBAA0B,SAASJ,GACtBA,EAASE,KAAKzE,IACpBe,UAAUQ,QAAQsD,OAAO,UAEhCD,uBAAwB,SAASL,GAC9B,IACIO,EADA9E,EAAMuE,EAASE,KAAKzE,IAGxBA,EAAIe,UAAUS,eAAewC,KAAK,kBAAkBe,KAAK,SAASvC,EAAEwC,GACjElC,KAAKC,MAAMC,QAAQ,EAAER,EAAI,IAAMwC,EAAGC,QAAQzF,KAAO,KAAOwF,EAAG7B,OAC3DnD,EAAIE,QAAQG,SAASmC,GAAGD,EAAIyC,EAAGC,QAAQzF,KACvCQ,EAAIE,QAAQG,SAASmC,GAAG6B,GAAKW,EAAG7B,MAC5BnD,EAAIE,QAAQI,iBAAmBkC,IAChCsC,EAAgBE,EAAG7B,SAIzBnD,EAAIqC,mBAGJrC,EAAIe,UAAUK,cAAciC,IAAIyB,GAChC9E,EAAIe,UAAUI,aAAakC,IAAIpB,KAAKqC,UAAUtE,EAAIE,QAAQG,WAE1DL,EAAIE,QAAQW,WAAY,EAExBb,EAAIe,UAAUQ,QAAQsD,OAAO,UAEhCK,cAAe,WACZ,IACGC,EADOlF,KACUc,UAAUI,aAAa,GACxCiE,EAFOnF,KAEWc,UAAUK,cAAc,GAG7C0B,KAAKuC,OAAOF,GAAYG,QAAQ,UAChCxC,KAAKuC,OAAOD,GAAaE,QAAQ,WAEpCzC,iBAAkB,SAAS0B,GACxB,IAAIvE,EAAMuE,EAASE,KAAKzE,IAExBA,EAAI4C,iBAAiB2B,GACrBvE,EAAIuF,eAEPlD,iBAAkB,WACf,IAEImD,EAFAxF,EAAMC,KACNuC,EAAI,KAOR,IAJAgD,EAAOxF,EAAIE,QAAQG,SAGnBL,EAAIE,QAAQM,UACPgC,EAAI,EAAGgD,EAAKrD,OAASK,EAAGA,GAAK,EAC9BxC,EAAIE,QAAQM,OAAOgF,EAAKhD,GAAGD,GAAKiD,EAAKhD,GAAG6B,IAI/CoB,QAAS,SAASC,GAEf,OADUzF,KACCC,QAAQM,OAAOkF,IAE7BH,YAAa,WACV,IACII,EAEAC,EAHA5F,EAAMC,KAEN4F,EAAY7F,EAAIE,QAAQI,gBAG5BqF,EACM,2GAEoC3F,EAAIE,QAAQR,SAASoG,cAAgB,4CAChC9F,EAAIE,QAAQR,SAASqG,cAAgB,uBAIpF1G,EAAE0F,KAAK/E,EAAIE,QAAQK,UAAW,SAAUyF,EAAOxG,GAC7CmG,GACA,gEAC2DE,GAAWG,EAAO,YAAY,IAAM,KAAOlD,KAAKmD,KAAKC,eAAe1G,GAAQ,8DAC5EqG,GAAWG,EAAO,YAAY,IAAM,KAClE,SAAzBhG,EAAIT,QAAQwE,SACd4B,GACA,qFAAuFnG,EAAO,YAAcsD,KAAKmD,KAAKC,eAAelG,EAAIyF,QAAQjG,IAAS,WAAaQ,EAAIE,QAAQP,UAAY,gBAAkBK,EAAIE,QAAQL,eAAiB,UAG9O8F,GACA,8EAAgFnG,EAAO,WAAaQ,EAAIE,QAAQP,UAAY,WAAaK,EAAIE,QAAQN,UAAY,KACjKkD,KAAKmD,KAAKC,eAAelG,EAAIyF,QAAQjG,IAAS,cAGhDmG,GACC,aAEHA,GACA,aAECC,EACK,4MAGyC5F,EAAIE,QAAQR,SAASyG,aAAe,8HAIpCnG,EAAIE,QAAQR,SAAS0G,aAAe,kIAK1ET,EACH,2BAGL3F,EAAIe,UAAUG,MAAMmF,OAAOT,GAE3B5F,EAAI+B,gBAGL/B,EAAIe,UAAUQ,QAAQsD,QAClByB,eAAe,EACfC,MAAevG,EAAIT,QAAQO,YAC3B0G,YAAe,EACfC,SAAe,IACfC,UAAe,IACfC,MAAe,OACfC,OAAe,OACfC,OAAe,EACfC,UAAiBC,GAAI,OAAQC,GAAI,cAAeC,GAAIjH,EAAIe,UAAUK,cAAc,IAChF8F,KAAM,WACHlH,EAAI8D,sBACJ9D,EAAI0E,qBACJ1E,EAAIe,UAAUS,eAAewC,KAAK,SAASmD,QAAQ3D,SAEtD4D,MAAO,WAEJ/H,EAAEY,MAAM4E,OAAO,WACf7E,EAAIe,UAAUQ,QAAQ8F,SACtBrH,EAAIe,UAAUE,UAAU+C,KAAK,sBAAsBqD,SAElB,WAA7BrH,EAAIE,QAAQU,aACbZ,EAAIe,UAAUO,WAAWkC,QACY,UAA7BxD,EAAIE,QAAQU,cACpBZ,EAAIe,UAAUK,cAAcoC,QAG/BxD,EAAIE,QAAQU,aAAe,YAG/B0G,GAAG,UAAW,SAASC,GAChBA,EAAIC,UAAYnI,EAAEoI,GAAGD,QAAQE,QAC7B1H,EAAIe,UAAUQ,QAAQsD,OAAO,SAEjC0C,EAAII,qBAKbjE,QAAS,WACN,IAAI1D,EAAMC,MAEmB,IAAzBD,EAAIE,QAAQS,WACbX,EAAIe,UAAUK,cACVU,KAAK,WAAW,YACpB9B,EAAIe,UAAUI,aAAaW,KAAK,WAAW,YAE3C9B,EAAIe,UAAUO,WACVQ,KAAK,WAAW,YAChB8F,OAAO,QAAS5H,EAAI6C,mBAG3B7C,EAAIE,QAAQS,UAAW,GAE1B8C,OAAQ,WACL,IAAIzD,EAAMC,MAEmB,IAAzBD,EAAIE,QAAQS,WACdX,EAAIe,UAAUK,cAAcyG,WAAW,YACvC7H,EAAIe,UAAUI,aAAa0G,WAAW,YACtC7H,EAAIe,UAAUO,WACVuG,WAAW,YACXlF,KAAK,SAAU3C,IAAKA,GAAMA,EAAI6C,kBAElC7C,EAAIE,QAAQS,UAAW","file":"jtl_item.min.js","sourcesContent":["/*\n * JTL Item v2.0 - http://apex.world/plugins/\n *\n * Licensed under MIT License (MIT)\n * Jorge Rimblas Â© 2017\n*/\n\n$.widget( \"tk.jtl_item\", {\n \n  // Default options.\n  options: {\n     lang: \"en\",\n     lang_codes: [\"en\",\"fr\",\"es\"],\n     messages: null,\n     fieldSize: 30,\n     fieldRows: 5,\n     fieldMaxLength: 80,\n     dialogTitle: null\n  },\n  _createPrivateStorage: function() {\n     var uiw = this;\n\n     uiw._values = {\n        apexItemId: '',\n        controlsId: '',\n        fieldSize: 30,\n        fieldMaxLength: 80,\n        dataJSON: {},\n        curr_lang_index: 0,\n        languages: {},\n        tagMap: {},\n        messages: $.parseJSON(uiw.options.messages),\n        totalLanguages: 0,\n        disabled: false,\n        focusOnClose: 'BUTTON', //BUTTON or INPUT,\n        newRecord: false,\n        signalChange: false\n     };\n\n     uiw._elements = {\n        $window: {},\n        $document: {},\n        $body: {},\n        $hiddenInput: {},\n        $displayInput: {},\n        $fieldset: {},\n        $mlsButton: {},\n        $dialog: {},\n        $dialogContent: {},\n        $saveButton: {},\n        $cancelButton: {},\n        $buttonContainer: {}\n     };\n  },\n  _create: function() {\n    var uiw = this;\n\n    // Options are already merged and stored in this.options (or uiw.options)\n\n    // helper function for finding the position of our current displayed language\n    function language_index (j, l) {\n      var i = null,\n          idx = -1;\n      for (i = 0; j.length > i && idx == -1; i += 1) {\n        if (j[i].l === l) {\n          idx = i;\n        }\n      }\n      return idx;\n    }\n\n    uiw._createPrivateStorage();\n    uiw._values.apexItemId = $(uiw.element).attr('id');\n    uiw._values.controlsId = uiw._values.apexItemId + '_fieldset';\n    uiw._initElements();\n    uiw._initBaseElements();\n\n    uiw._values.languages = JSON.parse(uiw.options.lang_codes);\n    uiw._values.totalLanguages = uiw._values.languages.length;\n\n    // get the fresh list of languages\n    uiw._initDataJSON();\n    uiw._initLanguageMap();\n    // Which position language are we using\n    uiw._values.curr_lang_index = language_index(uiw._values.dataJSON, uiw.options.lang);\n    \n    // Sync our hidden field with the actual value in the correct language, but\n    // also during page submit to make sure we submit the correct value \n    uiw._elements.$displayInput\n       .bind('change', {uiw: uiw}, uiw._syncHiddenField);\n    uiw._elements.$document\n       .bind('apexbeforepagesubmit', {uiw: uiw}, uiw._syncHiddenField);\n\n    uiw._elements.$mlsButton\n       .bind('click', {uiw: uiw}, uiw._handleOpenClick);\n\n    apex.debug.message(4,\"Registering with apex.widget.initPageItem: \" + uiw._elements.$displayInput.attr('id'));\n\n    apex.widget.initPageItem(uiw._elements.$hiddenInput.attr('id'), {\n       setValue: function(value, displayValue) {\n          uiw._elements.$displayInput.val(displayValue);\n          uiw._syncHiddenField();\n       },\n       getValue: function() {\n          return uiw._elements.$hiddenInput.val();\n       },\n       setFocus: function() {\n          uiw._elements.$displayInput.focus();\n       },\n       // show: function() {\n       //    uiw.show();\n       // },\n       // hide: function() {\n       //    uiw.hide();\n       // },\n       enable: function() {\n          uiw.enable();\n       },\n       disable: function() {\n          uiw.disable();\n       }\n    });\n\n  },\n  _initElements: function() {\n     var uiw = this;\n\n     uiw._elements.$window = $(window);\n     uiw._elements.$document = $(document);\n     uiw._elements.$body = $(document.body);\n     uiw._elements.$dialog = $('div.jtlitem-dialog');\n\n  },\n  _initDialogElements: function() {\n     var uiw = this;\n\n     uiw._elements.$dialog = $('div.jtlitem-dialog');\n     uiw._elements.$dialogContent = $('div.jtlitem-content');\n     uiw._elements.$saveButton = $('button.jtlitem-save-button');\n     uiw._elements.$cancelButton = $('button.jtlitem-cancel-button');\n\n  },\n  _initBaseElements: function() {\n     var uiw = this;\n\n     uiw._elements.$hiddenInput = uiw.element;\n     uiw._elements.$displayInput = $('#' + uiw._values.apexItemId + '_DISPLAY');     \n     uiw._values.fieldSize = uiw.options.itemType === \"TEXT\"? uiw._elements.$displayInput.attr(\"size\") : uiw._elements.$displayInput.attr(\"cols\");\n     if (uiw.options.itemType === \"TEXTAREA\") {\n       uiw._values.fieldRows = uiw._elements.$displayInput.attr(\"rows\");\n     }\n     uiw._values.fieldMaxLength = uiw._elements.$displayInput.attr(\"maxlength\");\n\n     uiw._elements.$fieldset = $('#' + uiw._values.controlsId);\n     uiw._elements.$mlsButton =\n        uiw._elements.$fieldset.find('button.jtlitem-modal-open');\n  },\n  _initDataJSON: function(){\n     var uiw = this,\n         jsonData = [],\n         input_data = uiw._elements.$hiddenInput.val();\n\n     if (input_data) {\n        uiw._values.dataJSON = JSON.parse(input_data);\n        uiw._values.newRecord = false;\n     }\n     else {\n        // The record is empty so we build a \n        // build JSON with this structure to seed it:\n        //  [ {\"l\": \"us\", \"tl\": \"Project Analysis\"}\n        //  , {\"l\": \"fr\", \"tl\": \"Analyse de projet\"}\n        //  , {\"l\": \"es\", \"tl\": \"Analisis de projecto\"}]\n        uiw._values.languages.forEach(function(l) {\n           jsonData.push({\"l\": l, \"tl\": \"\"});\n        });\n        // Init the hidden item\n        uiw._elements.$hiddenInput.val(JSON.stringify(jsonData));\n        uiw._values.dataJSON = jsonData;\n        uiw._values.newRecord = true;\n     }\n\n  },\n  _syncHiddenField: function(eventObj) {\n     // var uiw = eventObj.data.uiw,\n     var uiw,\n         langJSON = {},\n         lang_index;\n\n     if (typeof eventObj != \"undefined\") {\n        // we were call from an event\n        uiw = eventObj.data.uiw;\n     }\n     else {\n        // direct call\n        uiw = this;\n     }\n\n     lang_index = uiw._values.curr_lang_index;\n\n     if (uiw._values.newRecord) {\n        // save the new text into the ALL the records in the JSON structure\n        for (var i = uiw._values.totalLanguages - 1; i >= 0; i--) {\n          uiw._values.dataJSON[i].tl = uiw._elements.$displayInput.val();\n        }\n     }\n     else {\n        // save the new text into the JSON structure\n        uiw._values.dataJSON[lang_index].tl = uiw._elements.$displayInput.val();\n     }\n     // place the full JSON back into the hidden item\n     uiw._elements.$hiddenInput.val(JSON.stringify(uiw._values.dataJSON));\n     // Keep the map fresh (only needed for the dialog)\n     uiw._initLanguageMap();\n  },\n  _initDialogButtons: function() {\n     var uiw = this;\n\n     uiw._elements.$cancelButton\n        .bind('click', {uiw: uiw}, uiw._handleCancelButtonClick);\n\n     uiw._elements.$saveButton\n        .bind('click', {uiw: uiw}, uiw._handleSaveButtonClick);\n\n  },\n  _handleCancelButtonClick: function(eventObj) {\n     var uiw = eventObj.data.uiw;\n     uiw._elements.$dialog.dialog('close'); // this should cascade to remove the dialog\n  },\n  _handleSaveButtonClick: function(eventObj) {\n     var uiw = eventObj.data.uiw,\n         display_value;\n\n     uiw._elements.$dialogContent.find('.jtlitem-value').each(function(i,el){\n        apex.debug.message(4,i + \"(\" + el.dataset.lang + \"):\" + el.value);\n        uiw._values.dataJSON[i].l = el.dataset.lang;\n        uiw._values.dataJSON[i].tl = el.value;\n        if (uiw._values.curr_lang_index == i) {\n           display_value = el.value;\n        }\n     });\n\n     uiw._initLanguageMap();\n\n     // sync the items again\n     uiw._elements.$displayInput.val(display_value);\n     uiw._elements.$hiddenInput.val(JSON.stringify(uiw._values.dataJSON));\n     // uiw._signalChange();  // does the .val trigger a change already?\n     uiw._values.newRecord = false;\n\n     uiw._elements.$dialog.dialog('close'); // this should cascade to remove the dialog\n  },\n  _signalChange: function() {\n     var uiw = this,\n        hiddenElmt = uiw._elements.$hiddenInput[0],  // Do we use [0] or jquery object?\n        displayElmt = uiw._elements.$displayInput[0];\n\n     //Need apex.jQuery for the events to register with the DA framework\n     apex.jQuery(hiddenElmt).trigger('change');\n     apex.jQuery(displayElmt).trigger('change');\n  },\n  _handleOpenClick: function(eventObj) {\n     var uiw = eventObj.data.uiw;\n\n     uiw._syncHiddenField(eventObj);\n     uiw._showDialog();\n  },\n  _initLanguageMap: function() {\n     var uiw = this,\n         i = null,\n         tags = {};\n\n     tags = uiw._values.dataJSON;\n\n     // http://mattsnider.com/how-to-efficiently-search-a-json-array/\n     uiw._values.tagMap = {};\n     for (i = 0; tags.length > i; i += 1) {\n         uiw._values.tagMap[tags[i].l] = tags[i].tl;\n     }\n      \n  },\n  _hasTag: function(tagName) {\n     var uiw = this;\n     return uiw._values.tagMap[tagName];\n  },\n  _showDialog: function() {\n     var uiw = this,\n         langTable,\n         curr_lang = uiw._values.curr_lang_index,\n         dialogHtml;\n\n     langTable = \n           '<table class=\"t-Report-report\" summary=\"Available Translations\">\\n' +\n           ' <tr>\\n' +\n           '  <th class=\"t-Report-colHead\">' + uiw._values.messages.languageLabel + '</th>' +\n           '  <th class=\"t-Report-colHead u-tL\">' + uiw._values.messages.languageValue + '</th>' +\n           ' </tr>\\n' +\n           ' <tr>\\n';\n\n     $.each(uiw._values.languages, function( index, lang ) {\n       langTable +=\n       ' <tr>\\n' +\n       '  <td class=\"t-Report-cell t-Form-inputContainer u-tC' + (curr_lang==index? ' selected':'') + '\">' + apex.util.escapeHTMLAttr(lang) + '</td>' +\n       '  <td class=\"t-Report-cell t-Form-inputContainer u-tL' + (curr_lang==index? ' selected':'') + '\">';\n       if (uiw.options.itemType === \"TEXT\") {\n         langTable +=\n         '    <input type=\"text\" class=\"text_field apex-item-text jtlitem-value\" data-lang=\"' + lang + '\" value=\"' + apex.util.escapeHTMLAttr(uiw._hasTag(lang)) + '\" size=\"' + uiw._values.fieldSize + '\" maxlength=\"' + uiw._values.fieldMaxLength + '\"></td>';\n       }\n       else {\n         langTable +=\n         '    <textarea class=\"textarea apex-item-textarea jtlitem-value\" data-lang=\"' + lang + '\" cols=\"' + uiw._values.fieldSize + '\" rows=\"' + uiw._values.fieldRows + '\">' +\n         apex.util.escapeHTMLAttr(uiw._hasTag(lang)) + '</textarea>';\n       }\n\n       langTable +=\n        ' </tr>\\n';\n     });\n     langTable +=\n     '</table>\\n';\n\n      dialogHtml =\n           '<div class=\"jtlitem-dialog\"><div class=\"jtlitem-container ui-widget\">\\n' +\n           '  <div class=\"jtlitem-button-container\">\\n' +\n           '     <button class=\"jtlitem-cancel-button t-Button\">' +\n           '       <span class=\"t-Button-label\">' + uiw._values.messages.cancelButton + '</span>' +\n           // '       <span class=\"ui-icon ui-icon-close\"></span>' + \n           '     </button>\\n' +\n           '     <button class=\"jtlitem-save-button t-Button t-Button--hot\">' + \n           '       <span class=\"t-Button-label\">' + uiw._values.messages.applyChanges + '</span>' +\n           '       <span class=\"t-Icon t-Icon--right fa fa-check\"></span>' + \n           '     </button>\\n' +\n           '  </div>\\n' +\n           '  <div class=\"jtlitem-content\">\\n' +\n              langTable +\n           '  </div>\\n' +\n           '</div></div>\\n';\n\n      uiw._elements.$body.append(dialogHtml);\n\n      uiw._initElements();\n\n     // open created div as a dialog\n     uiw._elements.$dialog.dialog({\n         closeOnEscape: true,\n         title:         uiw.options.dialogTitle,\n         autoResize:    true,\n         minWidth:      400,\n         minHeight:     250,\n         width:         'auto',\n         height:        'auto',\n         modal:         true,\n         position:      { my: \"left\", at: \"left center\", of: uiw._elements.$displayInput[0] },\n         open: function() {\n            uiw._initDialogElements();\n            uiw._initDialogButtons();\n            uiw._elements.$dialogContent.find('input').first().focus();\n         },\n         close: function() {\n\n            $(this).dialog('destroy');\n            uiw._elements.$dialog.remove();\n            uiw._elements.$document.find('div.jtlitem-dialog').remove();\n\n            if (uiw._values.focusOnClose === 'BUTTON') {\n               uiw._elements.$mlsButton.focus();\n            } else if (uiw._values.focusOnClose === 'INPUT') {\n               uiw._elements.$displayInput.focus();\n            }\n\n            uiw._values.focusOnClose = 'BUTTON';\n         }\n       })\n       .on('keydown', function(evt) {\n           if (evt.keyCode === $.ui.keyCode.ESCAPE) {\n               uiw._elements.$dialog.dialog('close');\n           }                \n           evt.stopPropagation();\n       });\n\n\n  },\n  disable: function() {\n     var uiw = this;\n\n     if (uiw._values.disabled === false) {\n        uiw._elements.$displayInput\n           .attr('disabled','disabled');\n        uiw._elements.$hiddenInput.attr('disabled','disabled');\n\n        uiw._elements.$mlsButton\n           .attr('disabled','disabled')\n           .unbind('click', uiw._handleOpenClick);\n     }\n\n     uiw._values.disabled = true;\n  },\n  enable: function() {\n     var uiw = this;\n\n     if (uiw._values.disabled === true) {\n       uiw._elements.$displayInput.removeAttr('disabled');\n       uiw._elements.$hiddenInput.removeAttr('disabled');\n       uiw._elements.$mlsButton\n          .removeAttr('disabled')\n          .bind('click', {uiw: uiw}, uiw._handleOpenClick);\n\n       uiw._values.disabled = false;\n     }\n  }\n});\n//# sourceMappingURL=jtl_item.js.map\n"]}